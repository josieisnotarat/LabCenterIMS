/* Auto-generated legacy import script */
USE dbLabCenter;
GO
SET NOCOUNT ON;

DECLARE @DefaultDeptID INT = (SELECT intDepartmentID FROM dbo.TDepartments WHERE strDepartmentName = 'Electrical Engineering Tech');
DECLARE @CheckoutLabTechID INT = (SELECT intLabTechID FROM dbo.TLabTechs WHERE strFirstName = 'Josie');
IF @DefaultDeptID IS NULL OR @CheckoutLabTechID IS NULL
BEGIN
    RAISERROR('Required seed data not found. Ensure departments and lab techs are populated.', 16, 1);
    RETURN;
END

IF OBJECT_ID('tempdb..#LegacyLoans') IS NOT NULL DROP TABLE #LegacyLoans;
CREATE TABLE #LegacyLoans (
    LegacyRowID   INT IDENTITY(1,1) PRIMARY KEY,
    CheckoutDate  DATE        NOT NULL,
    SchoolID      VARCHAR(50) NULL,
    FirstName     VARCHAR(50) NULL,
    LastName      VARCHAR(50) NULL,
    Phone         VARCHAR(30) NULL,
    Instructor    VARCHAR(100) NULL,
    QtyLabel      VARCHAR(40) NULL,
    Material      VARCHAR(120) NOT NULL,
    ReturnStatus  VARCHAR(40) NULL,
    ReturnNote    VARCHAR(200) NULL
);

INSERT INTO #LegacyLoans (CheckoutDate, SchoolID, FirstName, LastName, Phone, Instructor, QtyLabel, Material, ReturnStatus, ReturnNote)
VALUES
    ('2023-05-24', '726743', 'Jonathan', 'Ehlman', '(513) 569-1762', 'Me', NULL, 'Everything', 'Disposable', NULL),
    ('2023-06-08', '475875', 'Clarence', 'Stepp', '(513) 404-3749', 'Ron', NULL, 'Digital Kit', 'Disposable', NULL),
    ('2023-06-08', '704399', 'Jessica', 'Cortez', '(831) 539-3969', 'Ron', NULL, 'Digital Kit', 'Yes', NULL),
    ('2023-06-08', '706770', 'Ryan', 'Kellam', '(859) 957-4988', 'Ron', NULL, 'Digital Kit', 'Yes', NULL),
    ('2023-06-08', '632672', 'Quintan', 'Mincy', '(513) 521-2381', 'Ron', NULL, 'Digital Kit', 'Yes', NULL),
    ('2023-06-08', '709786', 'Andrew', 'Morlan', '(513) 439-0915', 'Ron', NULL, 'Digital Kit', 'Yes', NULL),
    ('2023-06-08', '678189', 'Will', 'Smith', '(513) 609-0114', 'Ron', NULL, 'Digital Kit', 'Yes', NULL),
    ('2023-06-08', '683043', 'Spencer', 'Spek', '(937) 716-9020', 'Ron', NULL, 'Digital Kit', 'Yes', NULL),
    ('2023-06-08', '587445', 'Bryce', 'Washick', '(513) 657-8913', 'Ron', NULL, 'Digital Kit', 'Yes', NULL),
    ('2023-06-08', '587114', 'Ben', 'Wylie', '(513) 570-3925', 'Ron', NULL, 'Digital Kit', 'Yes', NULL),
    ('2023-06-09', NULL, 'Karen', 'McKinney', NULL, 'Doug', NULL, '3 AA Batteries', 'Disposable', NULL),
    ('2023-06-12', NULL, 'Thelson', 'Curry', '(513) 212-3243', NULL, NULL, 'Ir Unit, Reflector And Buzzer', 'Yes', NULL),
    ('2023-06-15', '678189', 'William', 'Smith', '(513) 609-0114', 'Ron', NULL, 'Trainer', 'Yes', NULL),
    ('2023-06-15', '475875', 'Clarance', 'Stepp', '(513) 404-3749', 'Singleton', NULL, 'Trainer', 'Yes', 'Counted as Loss'),
    ('2023-06-15', '475875', 'Clarance', 'Stepp', '(513) 404-3749', 'Singleton', NULL, 'Trainer', 'Yes', NULL),
    ('2023-06-15', '696703', 'Da''Quan', 'Allen', '(513) 604-4591', 'Ron', NULL, 'Trainer #27', 'Yes', NULL),
    ('2023-06-22', '696703', 'Da''Quan', 'Allen', '(513) 604-4591', 'Ron', NULL, 'Trainer', 'Yes', 'will renew tm'),
    ('2023-06-22', '696703', 'Da''Quan', 'Allen', '(513) 604-4591', 'Ron', NULL, 'Trainer', 'Yes', NULL),
    ('2023-06-22', '475875', 'Clarance', 'Stepp', '(513) 404-3749', 'Singleton', NULL, 'Trainer #26', 'Yes', NULL),
    ('2023-06-29', '696703', 'Da''Quan', 'Allen', '(513) 604-4591', 'Singleton', NULL, 'Trainer #30', 'Yes', NULL),
    ('2023-07-27', '587114', 'Ben', 'Wiley', '(513) 570-3925', 'Ron', '7', '7400 (Nand)', 'Yes', NULL),
    ('2023-07-27', '483907', 'Donald', 'Brill', '(513) 939-4863', 'Ron', NULL, 'Resistors And Orange Board', 'Yes', NULL),
    ('2023-07-27', '632672', 'Quintan', 'Mincy', '(513) 521-2381', 'Ron', NULL, 'Trainer #26', 'Yes', NULL),
    ('2023-08-03', '483907', 'Donald', 'Brill', '(513) 939-4863', 'Ron', '1', 'Red LED, 7408, 220 Resistor', 'Yes', NULL),
    ('2023-08-03', '695527', 'Kantima', 'Egngtion', NULL, 'Ron', '1', 'Resistors', 'Yes', NULL),
    ('2023-08-03', '483907', 'Donald', 'Brill', '(513) 939-4863', 'Ron', '1', 'Resistors And Breadboard', 'Yes', NULL),
    ('2023-08-03', '483907', 'Donald', 'Brill', '(513) 939-4863', 'Ron', '1', 'Resistors And Breadboard', 'Yes', NULL),
    ('2023-08-03', '695527', 'Kantima', 'Egngtion', NULL, 'Ron', '1', 'Resistors, LED And Breadboard', 'Yes', NULL),
    ('2023-08-03', '695527', 'Kantima', 'Egngtion', '(513) 364-5302', 'Ron', '1', 'Resistors, LED And Breadboard', 'Yes', NULL),
    ('2023-08-29', NULL, 'Mark', 'Cvg', NULL, 'Mark', '10', 'Calculators', 'Disposable', NULL),
    ('2023-08-30', '696703', 'Da''Quan', 'Allen', '513-604-4591', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2023-08-30', '620929', 'Mikayla', 'Harris', '513-692-3731', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2023-08-30', '716176', 'Quintanilla', 'Karen', 'Oh, you know', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2023-08-30', '702088', 'Mussa', 'Kebe', '513-306-1094', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2023-08-30', '702088', 'Moussa', 'Kebe', '513-306-1094', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2023-08-30', '700224', 'Erin', 'Moeller', '513-869-1177', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2023-08-30', '696723', 'Evan', 'Selles', '513-302-9660', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2023-08-30', '679236', 'Tanner', 'Sharpe', '612-597-7447', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2023-08-30', '701563', 'Joey', 'Tomamichel', '513-288-8539', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2023-08-30', '679236', 'Tanner', 'Sharpe', '612-597-7447', 'Geraldine', '1', 'Trainer #30', 'Yes', NULL),
    ('2023-08-30', '696703', 'Da''Quan', 'Allen', '513-604-4591', 'Geraldine', '1', 'Trainer #4', 'Yes', NULL),
    ('2023-09-05', '703415', 'Wesley', 'Ortiz', '513-787-0377', 'Ralph', '1', 'MSP430+USB Cable', 'Yes', NULL),
    ('2023-09-05', '716176', 'Quintanilla', 'Karen', 'Oh, you know :P', 'Ralph', '1', 'MSP430+USB Cable: #1', 'Yes', NULL),
    ('2023-09-05', '702088', 'Moussa', 'Kebe', '513-306-1094', 'Ralph', '1', 'MSP430+USB Cable: #2', 'Yes', 'Failed Class'),
    ('2023-09-05', '702088', 'Moussa', 'Kebe', '513-306-1094', 'Ralph', '1', 'MSP430+USB Cable: #2', 'Yes', NULL),
    ('2023-09-07', NULL, 'Bruce', 'Scherer', NULL, 'Bruce', '2', '3/32 Collet', 'Disposable', NULL),
    ('2023-09-07', '696703', 'Da''Quan', 'Allen', '513-604-4591', 'Ralph', '1', 'MSP430+USB Cable: #3', 'Yes', NULL),
    ('2023-09-11', '702964', 'Alexander', 'Bozhenov', '513-800-8247', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2023-09-11', '704399', 'Jess', 'Cortez', '831-539-3969', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2023-09-11', '507792', 'Andrew', 'Day', '859-444-3756', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2023-09-11', '716207', 'Mason', 'Earls', '812-655-4677', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2023-09-11', '716944', 'Max', 'Hall', '513-805-2605', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2023-09-11', '719233', 'Damon', 'Madaris', '513-374-5236', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2023-09-11', '680317', 'Cole', 'Quitter', '859-638-4570', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2023-09-11', NULL, 'Jacob', 'Simpson', '937-618-5847', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2023-09-11', '709999', 'Tanner', 'Thornberry', '859-640-1274', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2023-09-11', '706645', 'Minaj', 'Waeba', '513-306-1948', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2023-09-11', '683161', 'Katie', 'Wernicke', '513-462-2229', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2023-09-11', '704343', 'John', 'Wilson', '859-620-0250', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2023-09-11', '683161', 'Katie', 'Wernicke', ',Geraldine,1,Trainer #27,Yes,9/11/2023,716944,Max,Hall,', 'Geraldine', '1', 'Trainer #30', 'Yes', NULL),
    ('2024-03-26', '730163', 'Sam', 'Beccaccio', '(859) 462-5058', 'Geraldine', '1', 'Trainer #30', 'Yes', NULL),
    ('2024-04-08', '719233', 'Damen', 'Madaris', '513-374-5236', 'Geraldine', '1', 'Trainer #30', 'Yes', NULL),
    ('2024-04-09', '706645', 'Minaj', 'Waeba', '513-306-1948', 'Geraldine', '1', '7 Seg Display', 'Yes', NULL),
    ('2024-04-09', '730163', 'Sam', 'Beccaccio', '(859) 462-5058', 'Geraldine', '1', 'Trainer #3, 7-Segment Display', 'Yes', NULL),
    ('2024-04-15', '303364', 'Sean', 'Miller', '513-668-7423', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2024-04-15', '719233', 'Damen', 'Madaris', '513-374-5236', 'Geraldine', '1', 'Trainer #3', 'Yes', NULL),
    ('2024-04-16', '706645', 'Minaj', 'Waeba', '513-306-1948', 'Geraldine', '1', 'Trainer #3', 'Yes', NULL),
    ('2024-04-16', '730163', 'Sam', 'Beccaccio', '(859) 462-5058', 'Geraldine', '1', 'Trainer #30', 'Yes', NULL),
    ('2024-04-17', '495148', 'Jasmine', 'Hurst', '(704) 907-3211', '-', '1', 'HP Charger', 'Yes', NULL),
    ('2024-04-22', '719233', 'Damen', 'Madaris', '513-374-5236', 'Geraldine', '1', 'Trainer #30', 'Yes', NULL),
    ('2024-04-24', '730163', 'Sam', 'Beccaccio', '(859) 462-5058', 'Geraldine', '1', 'Trainer #3, 7-Segment Display', 'Yes', NULL),
    ('2024-04-25', '706645', 'Manoj', 'Waiba', '513-306-1948', 'Geraldine', '1', 'Trainer #1, 7-Segment Display', 'Yes', NULL),
    ('2024-04-29', '719233', 'Damen', 'Madaris', '513-374-5236', 'Geraldine', '1', 'Trainer #15', 'Yes', NULL),
    ('2024-05-02', NULL, 'Larry', 'Feist', NULL, 'Feist', '1', 'Toolkit 5', 'Disposable', NULL),
    ('2024-05-02', '706645', 'Manoj', 'Waiba', '513-306-1948', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2024-08-14', '719233', 'Damen', 'Madaris', '513-374-5236', 'Ray', '1', 'Calculator', 'Yes', NULL),
    ('2024-08-26', '699106', 'Alex', 'Masraum', '513-470-7774', 'Geraldine', '1', 'Digital Kit', 'Disposable', 'left voicemail'),
    ('2024-08-26', '706242', 'Isabella', 'Carmen', '513-497-7066', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2024-08-26', '739273', 'Joshua', 'Hoffman', '513-687-4090', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2024-08-26', '598689', 'Quincy', 'Milton', '513-616-2311', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2024-08-26', '682898', 'Dakota', 'Risch', '513-417-6479', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2024-08-26', '732516', 'Jacob', 'Steinmetz', '216-644-3967', 'Geraldine', '1', 'Digital Kit', 'Yes', 'left voicemail'),
    ('2024-08-26', '598689', 'Quincy', 'Milton', '513-616-2311', 'Geraldine', '1', 'Trainer #15', 'Yes', NULL),
    ('2024-08-26', '682898', 'Dakota', 'Risch', '513-417-6479', 'Geraldine', '1', 'Trainer #27', 'Yes', NULL),
    ('2024-08-26', '739273', 'Joshua', 'Hoffman', '513-687-4090', 'Geraldine', '1', 'Trainer #32', 'Yes', NULL),
    ('2024-08-26', '732516', 'Jacob', 'Steinmetz', '216-644-3967', 'Geraldine', '1', 'Trainer #34', 'Yes', NULL),
    ('2024-08-27', '671792', 'Aaron', 'Arocho', '(513) 254-1498', 'Curtis', '1', 'Breadboard', 'Disposable', NULL),
    ('2024-08-27', '671792', 'Aaron', 'Arocho', '(513) 254-1498', 'Curtis', '1', 'Instrumentation Kit #7', 'No', 'will drop off by friday'),
    ('2024-08-27', '680996', 'Zemirah', 'Torrey', '(513) 655-0954', 'Curtis', '1', 'Instrumentation Kit #12', 'Yes', NULL),
    ('2024-08-27', '738133', 'Colin', 'McCloy', '(513) 479-6857', 'Curtis', '1', 'Breadboard', 'Yes', NULL),
    ('2024-08-27', '664251', 'Andrew', 'Osburg', '(859) 640-5563', 'Curtis', '1', 'Instrumentation Kit #3', 'Yes', 'left voicemail'),
    ('2024-08-27', '738133', 'Colin', 'McCloy', '(513) 479-6857', 'Curtis', '1', 'Instrumentation Kit #4', 'Yes', NULL),
    ('2024-08-27', '151430', 'Rathana', 'Kreal', '(513) 407-0607', 'Curtis', '1', 'Instrumentation Kit #6', 'Yes', NULL),
    ('2024-08-27', '706242', 'Isabella', 'Carmen', '(513) 497-7066', 'Curtis', '1', 'Instrumentation Kit #8', 'Yes', NULL),
    ('2024-08-27', '680996', 'Zemirah', 'Torrey', '(513) 655-0954', 'Curtis', '1', 'Trainer #32', 'Yes', NULL),
    ('2024-08-27', '738133', 'Colin', 'McCloy', '(513) 479-6857', 'Curtis', '1', 'Trainer #34', 'Yes', NULL),
    ('2024-08-28', '719233', 'Damen', 'Madaris', '513-374-5236', 'Geraldine', '1', 'Trainer #32', 'Yes', NULL),
    ('2024-08-28', '695527', 'Kantima', 'Egngtion', '(513) 364-5302', 'Geraldine', '1', 'Breadboard', 'Yes', NULL),
    ('2024-08-28', '695527', 'Kantima', 'Egngtion', '(513) 364-5302', 'Geraldine', '1', 'Digital Kit', 'Yes', 'will bring on 12/18'),
    ('2024-08-28', '709439', 'Jorden', 'Hess', '513-444-7808', 'Geraldine', '1', 'Digital Kit', 'Yes', 'left voicemail'),
    ('2024-08-28', '719233', 'Damen', 'Madaris', '513-374-5236', 'Geraldine', '1', 'Digital Kit', 'Yes', 'will bring on 12/18'),
    ('2024-08-28', '709786', 'Andrew', 'Moreland', '513-439-0915', 'Geraldine', '1', 'Digital Kit', 'Yes', 'left voicemail'),
    ('2024-08-28', '678189', 'William', 'Smith', '513-609-0114', 'Geraldine', '1', 'Digital Kit', 'Yes', 'left voicemail'),
    ('2024-08-28', '695527', 'Kantima', 'Egngtion', '(513) 364-5302', 'Geraldine', '1', 'MSP430 #1', 'Yes', NULL),
    ('2024-08-28', '709786', 'Andrew', 'Moreland', '513-439-0915', 'Geraldine', '1', 'Trainer #27', 'Yes', NULL),
    ('2024-08-28', '717574', 'Andrew', 'Sliper', '(937) 705-9811', 'Curtis', '1', 'Trainer #27', 'Yes', NULL),
    ('2024-08-29', '717574', 'Andrew', 'Slipper', '(937) 705-9811', 'Curtis', '1', 'Motor Kit #6', 'Yes', NULL),
    ('2024-08-29', '730163', 'Sam', 'Beccaccio', '(859) 462-5058', 'Curtis', '1', 'Motor Kit #7', 'Yes', NULL),
    ('2024-08-29', '711504', 'Nelson', 'Malakada', '513-479-0684', 'Curtis', '1', 'Motor Kit #8', 'Yes', NULL),
    ('2024-08-29', '717574', 'Andrew', 'Slipper', '(937) 705-9811', 'Curtis', '1', 'Trainer #32', 'Yes', NULL),
    ('2024-08-30', '680996', 'Zemirah', 'Torrey', '(513) 655-0954', 'Curtis', '1', 'Trainer #27', 'Yes', NULL),
    ('2024-09-03', '717574', 'Andrew', 'Slipper', '(937) 705-9811', 'Curtis', '1', 'Instrumentation Kit #1', 'Yes', 'will bring on 12/18'),
    ('2024-09-03', '717574', 'Andrew', 'Slipper', '(937) 705-9811', 'Curtis', '1', 'Motor Kit #8', 'Yes', NULL),
    ('2024-09-03', '671792', 'Aaron', 'Arocho', '(513) 254-1498', 'Curtis', '1', 'Trainer #27', 'Yes', NULL),
    ('2024-09-03', '680996', 'Zemirah', 'Torrey', '(513) 655-0954', 'Curtis', '1', 'Trainer #32', 'Yes', NULL),
    ('2024-09-04', '716991', 'Garrett', 'Hornsby', '513-300-4346', 'Ralph', '1', 'Digital Kit', 'Yes', NULL),
    ('2024-09-04', '725150', 'Galyam', 'Korbogo', '513-978-8988', 'Ralph', '1', 'Digital Kit', 'Yes', 'left voicemail'),
    ('2024-09-04', '707595', 'Jarod', 'Moore', '513-575-6735', 'Ralph', '1', 'Digital Kit', 'Yes', 'Says he returned it'),
    ('2024-09-04', '731814', 'Jonathan', 'Nemi', '716-940-0074', 'Ralph', '1', 'Digital Kit', 'Yes', NULL),
    ('2024-09-04', '695941', 'Nicholas', 'Odgers', '513-678-4837', 'Ralph', '1', 'Digital Kit', 'Yes', 'wrong number'),
    ('2024-09-04', '708026', 'Justin', 'Owens', '513-316-5228', 'Ralph', '1', 'Digital Kit', 'Yes', NULL),
    ('2024-09-04', '658471', 'Noah', 'Patsfall', '513-846-5118', 'Geraldine', '1', 'Digital Kit', 'Yes', 'drop box return'),
    ('2024-09-04', '743939', 'Tyler', 'Vrh', '513-319-5211', 'Ralph', '1', 'Digital Kit', 'Yes', NULL),
    ('2024-09-04', '732670', 'Caroline', 'Wilbur', '904-333-2204', 'Ralph', '1', 'Digital Kit', 'Yes', NULL),
    ('2024-09-04', '708026', 'Justin', 'Owens', '513-316-5228', 'Ralph', '1', 'Trainer #15', 'Yes', NULL),
    ('2024-09-04', '716991', 'Garrett', 'Hornsby', '513-300-4346', 'Ralph', '1', 'Trainer #27', 'Yes', NULL),
    ('2024-09-04', '709786', 'Andrew', 'Moreland', '513-439-0915', 'Geraldine', '1', 'Trainer #27', 'Yes', NULL),
    ('2024-09-04', '708026', 'Justin', 'Owens', '513-316-5228', 'Ralph', '1', 'Trainer #27', 'Yes', NULL),
    ('2024-09-04', '707595', 'Jarod', 'Moore', '513-575-6735', 'Ralph', '1', 'Trainer #31', 'Yes', NULL),
    ('2024-09-04', '725150', 'Galyam', 'Korbogo', '513-978-8988', 'Ralph', '1', 'Trainer #32', 'Yes', NULL),
    ('2024-09-04', '732670', 'Caroline', 'Wilbur', '904-333-2204', 'Ralph', '1', 'Trainer #34', 'Yes', NULL),
    ('2024-09-04', '719233', 'Damen', 'Madaris', '513-374-5236', 'Geraldine', '1', 'Trainer #9', 'Yes', NULL),
    ('2024-09-04', '695941', 'Nicholas', 'Odgers', '513-678-4837', 'Ralph', '1', 'Trainer #9', 'Yes', NULL),
    ('2024-09-05', '722073', 'Abagial', 'Atwood', '513-544-8101', 'Curtis', '1', 'Instrumentation Kit #9', 'No', 'left voicemail'),
    ('2024-09-09', NULL, 'Jody', 'Black', NULL, NULL, '1', 'HP Charger', 'Yes', NULL),
    ('2024-09-10', '711504', 'Nelson', 'Makada', '(513) 479-0684', 'Curtis', '1', 'Instrumentation Kit #5, Breadboard', 'Temporarily Yes', NULL),
    ('2024-09-10', '711504', 'Nelson', 'Makada', '(513) 479-0684', 'Curtis', '1', 'Digital Trainer #32', 'Yes', NULL),
    ('2024-09-11', '708026', 'Justin', 'Owens', '513-316-5228', 'Ralph', '1', 'Trainer #31', 'Yes', NULL),
    ('2024-09-11', '707595', 'Jarod', 'Moore', '513-575-6735', 'Ralph', '1', 'Trainer #32', 'Yes', NULL),
    ('2024-09-11', '719233', 'Damen', 'Madaris', '513-374-5236', 'Geraldine', '1', 'Trainer #43', 'Yes', NULL),
    ('2024-09-16', '708890', 'Bryce', 'Drake', '(513) 609-6551', 'Savrda', '1', 'Trainer #31', 'Yes', NULL),
    ('2024-09-16', '682898', 'Dakota', 'Risch', '(513) 417-6479', 'Savrda', '1', 'Trainer #42', 'Yes', NULL),
    ('2024-09-17', '711504', 'Nelson', 'Malakada', '513-479-0684', 'Curtis', '1', 'Motor Kit #8', 'Yes', NULL),
    ('2024-09-17', '722073', 'Abagial', 'Atwood', '513-544-8101', 'Curtis', '1', 'Trainer #41', 'Yes', NULL),
    ('2024-09-18', '719233', 'Damen', 'Madaris', '513-374-5236', 'Geraldine', '1', 'Trainer #3', 'Yes', NULL),
    ('2024-09-18', '732670', 'Caroline', 'Wilbur', '904-333-2204', 'Ralph', '1', 'Trainer #41', 'Yes', NULL),
    ('2024-09-19', '706242', 'Isabella', 'Carmen', '(513) 497-7066', 'Curtis', '1', 'Motor & Control Kit 8', 'Yes', NULL),
    ('2024-09-23', '708890', 'Bryce', 'Drake', '(513) 609-6551', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2024-09-23', '726553', 'Eric', 'Medly', '(513) 446-9639', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2024-09-23', '717561', 'Omar', 'Sheta', '(513) 288-4216', 'Savrda', '1', 'Digital Kit', 'Yes', NULL),
    ('2024-09-23', NULL, 'Ann', 'Gunkel', '(513) 569-1783', NULL, NULL, 'Green Extension Cable', 'Yes', NULL),
    ('2024-09-23', '717561', 'Omar', 'Sheta', '(513) 288-4216', 'Savrda', '1', 'Trainer #31', 'Yes', NULL),
    ('2024-09-23', '708890', 'Bryce', 'Drake', '(513) 609-6551', 'Geraldine', '1', 'Trainer #42', 'Yes', NULL),
    ('2024-09-25', '719233', 'Damen', 'Madaris', '513-374-5236', 'Geraldine', '1', 'Trainer #42', 'Yes', NULL),
    ('2024-09-25', '732670', 'Caroline', 'Wilbur', '904-333-2204', 'Ralph', '1', 'Trainer #42', 'Yes', NULL),
    ('2024-09-30', '717561', 'Omar', 'Sheta', '(513) 288-4216', 'Savrda', '1', 'Trainer #42', 'Yes', NULL),
    ('2024-10-02', '719233', 'Damen', 'Madaris', '513-374-5236', 'Geraldine', '1', 'Trainer #3', 'Yes', NULL),
    ('2024-10-04', '656484', 'Avana', 'Hilton', '(513) 208-0538', 'Ralph', '1', 'Microcontroller #2', 'Yes', 'left voicemail i think lol'),
    ('2024-10-07', '717561', 'Omar', 'Sheta', '(513) 288-4216', 'Savrda', '1', 'Trainer #3', 'Yes', NULL),
    ('2024-10-08', '151430', 'Rathana', 'Kreal', '(513) 407-0607', NULL, '1', 'Soldering Kit #17', 'Yes', NULL),
    ('2024-10-09', '719233', 'Damen', 'Madaris', '513-374-5236', 'Geraldine', '1', 'Trainer #42', 'Yes', NULL),
    ('2024-10-15', '680996', 'Zemirah', 'Torrey', '(513) 655-0954', 'Curtis', '1', 'Trainer #42', 'Yes', NULL),
    ('2024-10-16', '711504', 'Nelson', 'Makada', '(513) 479-0684', 'Curtis', '1', 'Instrumentation Kit #5', 'Yes', 'bro has no voicemail box'),
    ('2024-10-16', '719233', 'Damen', 'Madaris', '513-374-5236', 'Geraldine', '1', 'Trainer #42', 'Yes', NULL),
    ('2024-10-16', '732670', 'Caroline', 'Wilbur', '904-333-2204', 'Ralph', '1', 'Trainer #42', 'Yes', NULL),
    ('2024-10-17', '680996', 'Zemirah', 'Torrey', '(513) 655-0954', 'Curtis', '1', 'Trainer #31', 'Yes', NULL),
    ('2024-10-18', '680996', 'Zemirah', 'Torrey', '(513) 655-0954', 'Curtis', '1', 'Trainer #42', 'Yes', NULL),
    ('2024-10-21', '680996', 'Zemirah', 'Torrey', '(513) 655-0954', 'Curtis', '1', 'Trainer #42', 'Yes', NULL),
    ('2024-10-21', '680996', 'Zemirah', 'Torrey', '(513) 655-0954', 'Curtis', '1', 'Trainer #43', 'Yes', NULL),
    ('2024-10-21', '719233', 'Damen', 'Madaris', '513-374-5236', 'Geraldine', '1', 'Trainer #31', 'Yes', NULL),
    ('2024-10-21', '711504', 'Nelson', 'Malakada', '513-479-0684', 'Curtis', '1', 'Trainer #31', 'Yes', NULL),
    ('2024-10-23', '732670', 'Caroline', 'Wilbur', '904-333-2204', 'Ralph', '1', 'Trainer #31', 'Yes', NULL),
    ('2024-10-24', '730163', 'Sam', 'Beccaccio', '(859) 462-5058', 'Curtis', '1', 'Motor Kit #8', 'Yes', NULL),
    ('2024-10-29', '706242', 'Isabella', 'Carmen', '(513) 497-7066', 'Curtis', '1', 'Motor & Control Kit 6', 'Yes', NULL),
    ('2024-10-29', '730163', 'Sam', 'Beccaccio', '(859) 462-5058', 'Curtis', '1', 'Motor Kit #7', 'Yes', NULL),
    ('2024-10-29', '680996', 'Zemirah', 'Torrey', '(513) 655-0954', 'Curtis', '1', 'Trainer #31', 'Yes', NULL),
    ('2024-10-31', '730163', 'Sam', 'Beccaccio', '(859) 462-5058', 'Curtis', '1', 'Motor Kit #8', 'Yes', NULL),
    ('2024-11-04', '726553', 'Eric', 'Medly', '(513) 446-9639', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2024-11-04', '717561', 'Omar', 'Sheta', '(513) 288-4216', 'Savrda', '1', 'Trainer #41', 'Yes', NULL),
    ('2024-11-04', '726553', 'Eric', 'Medly', '(513) 446-9639', 'Geraldine', '1', 'Trainer #31', 'Yes', NULL),
    ('2024-11-04', '732670', 'Caroline', 'Wilbur', '904-333-2204', 'Ralph', '1', 'Trainer #31 Breadboard', 'Yes', NULL),
    ('2024-11-05', '706242', 'Isabella', 'Carmen', '(513) 497-7066', 'Curtis', '1', 'Motor & Control Kit 8', 'Yes', NULL),
    ('2024-11-05', '680996', 'Zemirah', 'Torrey', '(513) 655-0954', 'Curtis', '1', 'Trainer #41', 'Yes', NULL),
    ('2024-11-06', '732670', 'Caroline', 'Wilbur', '904-333-2204', 'Ralph', '1', 'Trainer #41', 'Yes', NULL),
    ('2024-11-06', '725150', 'Galyan', 'Korbeogo', '(513) 978-8988', 'Ralph', '1', 'Trainer #32', 'Yes', NULL),
    ('2024-11-07', '711504', 'Nelson', 'Malakada', '513-479-0684', 'Curtis', '1', 'Trainer #32', 'Yes', NULL),
    ('2024-11-12', '730163', 'Sam', 'Beccaccio', '(859) 462-5058', 'Curtis', '1', 'Motor Kit #3', 'Yes', NULL),
    ('2024-11-13', '709439', 'Jorden', 'Hess', '513-444-7808', 'Geraldine', '1', 'Breadboard', 'Yes', NULL),
    ('2024-11-13', '709786', 'Andrew', 'Moreland', '513-439-0915', 'Geraldine', '1', 'Breadboard', 'Yes', NULL),
    ('2024-11-13', '678189', 'William', 'Smith', '513-609-0114', 'Geraldine', '1', 'Breadboard', 'Yes', NULL),
    ('2024-11-13', '656484', 'Avana', 'Hilton', '(513) 208-0538', 'Ralph', '1', 'Trainer #32', 'Yes', NULL),
    ('2024-11-13', '732670', 'Caroline', 'Wilbur', '904-333-2204', 'Ralph', '1', 'Trainer #42', 'Yes', NULL),
    ('2024-11-14', '730163', 'Sam', 'Beccaccio', '(859) 462-5058', 'Curtis', '1', 'Motor Kit #3', 'Yes', NULL),
    ('2024-11-15', NULL, 'Jody', 'Black', '(513) 330-0078', NULL, '1', 'HP Charger', 'Yes', NULL),
    ('2024-11-18', '719233', 'Damen', 'Madaris', '513-374-5236', 'Geraldine', '1', 'Breadboard', 'Yes', NULL),
    ('2024-11-18', '717561', 'Omar', 'Sheta', '(513) 288-4216', 'Savrda', '1', 'Trainer #42', 'Yes', NULL),
    ('2024-11-19', '712169', 'Alexander', 'Taylor', '(513) 516-6673', 'Savrda', '1', '2 Probes +Breadboard', 'Yes', NULL),
    ('2024-11-19', '706242', 'Isabella', 'Carmen', '(513) 497-7066', 'Curtis', '1', 'Motor & Control Kit 3', 'Yes', NULL),
    ('2024-11-19', '730163', 'Sam', 'Beccaccio', '(859) 462-5058', 'Curtis', '1', 'Motor Kit #8', 'Yes', NULL),
    ('2024-11-20', '231805', 'Amy', 'Gutman Fuentes', '(513) 706-9524', 'Geraldine', '1', 'Breadboard', 'Yes', NULL),
    ('2024-11-20', '709925', 'Andrew', 'Lakes', '(513) 903-0701', 'Geraldine', '1', 'Probes X3', 'Yes', NULL),
    ('2024-11-25', '717561', 'Omar', 'Sheta', '(513) 288-4216', 'Savrda', '1', 'Trainer #42', 'Yes', NULL),
    ('2024-12-02', '717561', 'Omar', 'Sheta', '(513) 288-4216', 'Savrda', '1', 'Trainer #41', 'Yes', NULL),
    ('2024-12-03', '680996', 'Zemirah', 'Torrey', '(513) 655-0954', 'Curtis', '1', 'Trainer #3', 'Yes', NULL),
    ('2024-12-04', '680996', 'Zemirah', 'Torrey', '(513) 655-0954', 'Curtis', '1', 'Trainer #31', 'Yes', NULL),
    ('2024-12-04', '725150', 'Galyan', 'Korbeogo', '(513) 978-8988', 'Ralph', '1', 'Trainer #34', 'Yes', NULL),
    ('2024-12-04', '732670', 'Caroline', 'Wilbur', '904-333-2204', 'Ralph', '1', 'Trainer #42', 'Yes', NULL),
    ('2024-12-05', '695527', 'Kantima', 'Egngtion', '(513) 364-5302', 'Geraldine', '1', '7-Segment Display', 'Yes', NULL),
    ('2024-12-05', '695527', 'Kantima', 'Egngtion', '(513) 364-5302', 'Geraldine', '2', '74190 Chip', 'Yes', NULL),
    ('2024-12-05', '695527', 'Kantima', 'Egngtion', '(513) 364-5302', 'Geraldine', '1', 'Trainer #31', 'Yes', NULL),
    ('2024-12-09', '680996', 'Zemirah', 'Torrey', '(513) 655-0954', 'Curtis', '1', 'Trainer #9', 'Yes', NULL),
    ('2024-12-11', '709786', 'Andrew', 'Moreland', '513-439-0915', 'Geraldine', '1', 'Breadboard', 'Disposable', NULL),
    ('2024-12-11', '708026', 'Jackson', 'Owens', '513-316-5228', 'Ralph', '1', 'Trainer #31', 'Yes', NULL),
    ('2024-12-11', '725150', 'Galyam', 'Korbeogo', NULL, 'Geraldine', '1', 'Trainer #41', 'Yes', NULL),
    ('2024-12-11', '732670', 'Caroline', 'Wilbur', '904-333-2204', 'Ralph', '1', 'Trainer #41', 'Yes', NULL),
    ('2025-01-13', '732209', 'Jonah', 'Baldwin', '513-503-9819', 'Geraldine', '1', 'Digital Kit', 'No', NULL),
    ('2025-01-13', '741979', 'Gerald', 'Cummings', '937-620-1894', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2025-01-13', '682677', 'Evan', 'Frank', '513-616-4462', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2025-01-13', '671816', 'Nathan', 'McClellan', '513-801-0896', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2025-01-13', '682677', 'Evan', 'Frank', '513-616-4462', 'Geraldine', '1', 'Trainer #30', 'Yes', NULL),
    ('2025-01-13', '671816', 'Nathan', 'McClellan', '513-801-0896', 'Geraldine', '1', 'Trainer #32', 'Yes', NULL),
    ('2025-01-13', NULL, 'Geraldine', 'Danger', NULL, 'Geraldine', '1', 'Trainer #34', 'Yes', NULL),
    ('2025-01-13', '732209', 'Jonah', 'Baldwin', '513-503-9819', 'Geraldine', '1', 'Trainer #41', 'Yes', NULL),
    ('2025-01-13', '741979', 'Gerald', 'Cummings', '937-620-1894', 'Geraldine', '1', 'Trainer #42', 'Yes', NULL),
    ('2025-01-14', '738234', 'Ben', 'Weber', '(812) 716-6481', 'Curtis', '1', 'Instrumentation Kit #13', 'Yes', NULL),
    ('2025-01-14', '738862', 'Ethan', 'Alexander', '(929) 888-3555', 'Waley', '1', 'Digital Kit', 'Yes', NULL),
    ('2025-01-14', '727389', 'Allison', 'Carr', '(859) 446-8632', 'Waley', '1', 'Digital Kit', 'Yes', NULL),
    ('2025-01-14', '735376', 'Anthony', 'Franks', '(740) 504-6680', 'Waley', '1', 'Digital Kit', 'Yes', NULL),
    ('2025-01-14', '739273', 'Joshua', 'Hoffman', '(513) 687-4090', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2025-01-14', '687366', 'Miles', 'Landon', '(513) 908-5744', 'Waley', '1', 'Digital Kit', 'Yes', NULL),
    ('2025-01-14', '699442', 'Benie', 'Lumbuambu', '(859) 415-7196', 'Waley', '1', 'Digital Kit', 'Yes', NULL),
    ('2025-01-14', '738133', 'Collin', 'McCloy', '(513) 479-6857', 'Waley', '1', 'Digital Kit', 'Yes', NULL),
    ('2025-01-14', '726553', 'Eric', 'Medley', '(513) 446-9639', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2025-01-14', '695941', 'Nicholas', 'Odgers', '(513) 678-4837', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2025-01-14', '727050', 'Lucy', 'Wang', '(513) 886-9513', 'Waley', '1', 'Digital Kit', 'Yes', NULL),
    ('2025-01-14', '721046', 'Cecil', 'Payne', '(513) 439-0888', 'Curtis', '1', 'Instrumentation Kit #4', 'Yes', NULL),
    ('2025-01-14', '731464', 'Logan', 'Grever', '(859) 391-2090', 'Curtis', '1', 'Instrumentation Kit #12', 'Yes', NULL),
    ('2025-01-14', '732209', 'Jonah', 'Baldwin', '(513) 503-9819', 'Curtis', '1', 'Instrumentation Kit #14', 'Yes', NULL),
    ('2025-01-14', '735841', 'Jesse', 'Cooper', '(801) 889-0623', 'Curtis', '1', 'Instrumentation Kit #1', 'Yes', NULL),
    ('2025-01-21', '633360', 'Adrian', 'Bacon', '(513) 264-9579', NULL, '1', 'Digital Kit', 'No', NULL),
    ('2025-01-21', '617633', 'Caleb', 'Brennan', '(513) 497-8301', 'Waley', '1', 'Digital Kit', 'No', NULL),
    ('2025-01-21', '717461', 'Simon', 'Valdez', '(859) 240-9186', 'Ralph', '1', 'Digital Kit', 'No', NULL),
    ('2025-01-21', '725150', 'Galyam', 'Korbogo', '513-978-8988', 'Ralph', '1', 'Digital Kit', 'Yes', NULL),
    ('2025-01-21', '708026', 'Justin', 'Owens', '513-316-5228', 'Ralph', '1', 'Digital Kit', 'Yes', NULL),
    ('2025-01-21', '711504', 'Nelson', 'Makada', '513-479-0684', 'Curtis', '1', 'Instrumentation Kit #3', 'Yes', NULL),
    ('2025-01-21', '711504', 'Nelson', 'Makada', '513-479-0684', 'Curtis', '1', 'Phillips Screwdriver', 'Yes', NULL),
    ('2025-01-21', '717461', 'Simon', 'Valdez', '(859) 240-9186', 'Ralph', '1', 'Trainer #31', 'Yes', NULL),
    ('2025-01-21', '687366', 'Miles', 'Landon', '(513) 908-5744', 'Waley', '1', 'Trainer #32', 'Yes', NULL),
    ('2025-01-21', '699442', 'Benie', 'Lumbuambu', '(859) 415-7196', 'Waley', '1', 'Trainer #34', 'Yes', NULL),
    ('2025-01-21', '727050', 'Lucy', 'Wang', '(513) 886-9513', 'Waley', '1', 'Trainer #42', 'Yes', NULL),
    ('2025-01-21', '617633', 'Caleb', 'Brennan', '(513) 497-8301', 'Waley', '1', 'Trainer #8', 'Yes', NULL),
    ('2025-01-23', '721046', 'Cecil', 'Payne', '(513) 439-0888', 'Curtis', '1', 'Trainer #32', 'Yes', NULL),
    ('2025-01-27', '741979', 'Gerald', 'Cummings', '937-620-1894', 'Geraldine', '1', 'Trainer #32', 'Yes', NULL),
    ('2025-01-27', '732209', 'Jonah', 'Baldwin', '513-503-9819', 'Geraldine', '1', 'Trainer #34', 'Yes', NULL),
    ('2025-01-27', '671816', 'Nathan', 'McClellan', '513-801-0896', 'Geraldine', '1', 'Trainer #42', 'Yes', NULL),
    ('2025-01-28', '687366', 'Miles', 'Landon', '(513) 908-5744', 'Waley', '1', 'Trainer #9', 'Yes', NULL),
    ('2025-01-28', '617633', 'Caleb', 'Brennan', '(513) 497-8301', 'Waley', '1', 'Trainer #31', 'Yes', NULL),
    ('2025-01-28', '699442', 'Benie', 'Lumbuambu', '(859) 415-7196', 'Waley', '1', 'Trainer #31', 'Yes', NULL),
    ('2025-01-28', '727050', 'Lucy', 'Wang', '(513) 886-9513', 'Waley', '1', 'Trainer #41', 'Yes', NULL),
    ('2025-02-03', '671816', 'Nathan', 'McClellan', '513-801-0896', 'Geraldine', '1', 'Trainer #31', 'Yes', NULL),
    ('2025-02-03', '741979', 'Gerald', 'Cummings', '937-620-1894', 'Geraldine', '1', 'Trainer #32', 'Yes', NULL),
    ('2025-02-03', '732209', 'Jonah', 'Baldwin', '513-503-9819', 'Geraldine', '1', 'Trainer #41', 'Yes', NULL),
    ('2025-02-04', '617633', 'Caleb', 'Brennan', '(513) 497-8301', 'Waley', '1', 'Trainer #34', 'Yes', NULL),
    ('2025-02-10', '732209', 'Jonah', 'Baldwin', '513-503-9819', 'Geraldine', '1', 'Trainer #31', 'Yes', NULL),
    ('2025-02-10', '741979', 'Gerald', 'Cummings', '937-620-1894', 'Geraldine', '1', 'Trainer #41', 'Yes', NULL),
    ('2025-02-10', '671816', 'Nathan', 'McClellan', '513-801-0896', 'Geraldine', '1', 'Trainer #42', 'Yes', NULL),
    ('2025-02-11', '699442', 'Benie', 'Lumbuambu', '(859) 415-7196', 'Waley', '1', 'Trainer #31', 'Yes', NULL),
    ('2025-02-11', '633360', 'Adrian', 'Bacon', '(513) 264-9579', NULL, '1', 'Trainer #31 + Temp Deg Kit', 'Yes', NULL),
    ('2025-02-11', '732209', 'Jonah', 'Baldwin', '513-503-9819', 'Geraldine', '1', 'Trainer #34', 'Yes', NULL),
    ('2025-02-11', '617633', 'Caleb', 'Brennan', '(513) 497-8301', 'Waley', '1', 'Trainer #42', 'Yes', NULL),
    ('2025-02-13', '738234', 'Benjamin', 'Weber', '812-716-6481', 'Curtis', '1', 'Trainer #31', 'Yes', NULL),
    ('2025-02-18', '633360', 'Adrian', 'Bacon', '(513) 264-9579', 'Geraldine', '1', '7-Segment', 'Yes', NULL),
    ('2025-02-18', '739273', 'Joshua', 'Hoffman', '(513) 687-4090', 'Geraldine', '1', '7-Segment', 'Yes', NULL),
    ('2025-02-18', '725150', 'Galyam', 'Korbogo', '513-978-8988', 'Geraldine', '1', '7-Segment', 'Yes', NULL),
    ('2025-02-18', '708026', 'Justin', 'Owens', '513-316-5228', 'Geraldine', '1', '7-Segment', 'Yes', NULL),
    ('2025-02-18', '726553', 'Eric', 'Medley', '(513) 446-9639', 'Geraldine', '1', '7-Segment Display', 'Yes', NULL),
    ('2025-02-18', '695941', 'Nicholas', 'Odgers', '(513) 678-4837', 'Geraldine', '1', '7-Segmentment Display', 'Yes', NULL),
    ('2025-02-25', NULL, 'Kid', 'Unknown', NULL, NULL, 'a few', 'Chips For Personal Project', 'Disposable', NULL),
    ('2025-02-25', '739273', 'Joshua', 'Hoffman', '(513) 687-4090', 'Geraldine', '1', '7-Segment', 'No', NULL),
    ('2025-02-25', '725150', 'Galyam', 'Korbogo', '513-978-8988', 'Geraldine', '1', '7-Segment', 'No', NULL),
    ('2025-02-25', '708026', 'Justin', 'Owens', '513-316-5228', 'Geraldine', '1', '7-Segment', 'No', NULL),
    ('2025-02-25', '726553', 'Eric', 'Medley', '(513) 446-9639', 'Geraldine', '1', '7-Segment Display', 'Yes', NULL),
    ('2025-02-25', '695941', 'Nicholas', 'Odgers', '(513) 678-4837', 'Geraldine', '1', '7-Segmentment Display', 'Yes', NULL),
    ('2025-02-25', '699442', 'Benie', 'Lumbuambu', '(859) 415-7196', 'Waley', '1', 'Trainer #31', 'Yes', NULL),
    ('2025-02-25', '617633', 'Caleb', 'Brennan', '(513) 497-8301', 'Waley', '1', 'Trainer #34', 'Yes', NULL),
    ('2025-02-25', '738133', 'Collin', 'McCloy', '(513) 479-6857', 'Waley', '1', 'Trainer #41', 'Yes', NULL),
    ('2025-03-03', '#1461', 'Jonah', 'Baldwin', '513-503-9819', 'Curtis', '1', 'Motor Kit #3, Multimeter', 'Yes', NULL),
    ('2025-03-03', '716944', 'Max', 'Hall', '(513) 805-2605', 'Curtis', '1', 'Motor Kit #4, Multimeter', 'Yes', NULL),
    ('2025-03-03', '#3698', 'Aaron', 'Arocho', '513-254-1498', 'Curtis', '1', 'Motor Kit #5', 'Yes', NULL),
    ('2025-03-03', '#0685', 'Meka', 'Nwachukwu', '347-279-1996', 'Curtis', '1', 'Motor Kit #6, Multimeter', 'Yes', NULL),
    ('2025-03-03', '721046', 'Cecil', 'Payne', '513-439-0888', 'Curtis', '1', 'Motor Kit #7, Multimeter', 'Yes', NULL),
    ('2025-03-03', 'Curtis', 'Curtis', 'Curtis', 'Curtis', 'Curtis', '1', 'Motor Kit #8', 'Yes', NULL),
    ('2025-03-03', '741979', 'Gerald', 'Cummings', '937-620-1894', 'Geraldine', '1', 'Trainer #31', 'Yes', NULL),
    ('2025-03-03', '#1461', 'Jonah', 'Baldwin', '513-503-9819', 'Curtis', '1', 'Trainer #34', 'Yes', NULL),
    ('2025-03-03', '671816', 'Nathan', 'McClellan', '513-801-0896', 'Geraldine', '1', 'Trainer #41', 'Yes', NULL),
    ('2025-03-03', '678189', 'William', 'Smith', '513-609-0114', 'Geraldine', '~~', 'Various Hookup Wires For MSP430', 'Yes', NULL),
    ('2025-03-04', '617633', 'Caleb', 'Brennan', '(513) 497-8301', 'Waley', '1', 'Trainer #32', 'Yes', NULL),
    ('2025-03-04', '699442', 'Benie', 'Lumbuambu', '(859) 415-7196', 'Waley', '1', 'Trainer #42', 'Yes', NULL),
    ('2025-03-10', '#0685', 'Meka', 'Nwachukwu', '347-279-1996', 'Curtis', '1', 'Motor Kit #3', 'Yes', NULL),
    ('2025-03-11', '617633', 'Caleb', 'Brennan', '(513) 497-8301', 'Waley', '1', 'Trainer #34', 'Yes', NULL),
    ('2025-03-17', '741979', 'Gerald', 'Cummings', '937-620-1894', 'Geraldine', '1', 'Trainer #31', 'Yes', NULL),
    ('2025-03-17', '671816', 'Nathan', 'McClellan', '513-801-0896', 'Geraldine', '1', 'Trainer #41', 'Yes', NULL),
    ('2025-03-18', '617633', 'Caleb', 'Brennan', '(513) 497-8301', 'Waley', '1', 'Trainer #9', 'Yes', NULL),
    ('2025-03-18', '738133', 'Collin', 'McCloy', '(513) 479-6857', 'Waley', '1', 'Trainer #34', 'Yes', NULL),
    ('2025-03-18', '699442', 'Benie', 'Lumbuambu', '(859) 415-7196', 'Waley', '1', 'Trainer #42', 'Yes', NULL),
    ('2025-03-24', '671816', 'Nathan', 'McClellan', '513-801-0896', 'Geraldine', '1', 'Trainer #9', 'Yes', NULL),
    ('2025-03-24', '#1461', 'Jonah', 'Baldwin', '513-503-9819', 'Curtis', '1', 'Trainer #31', 'Yes', NULL),
    ('2025-03-24', '741979', 'Gerald', 'Cummings', '937-620-1894', 'Geraldine', '1', 'Trainer #42', 'Yes', NULL),
    ('2025-03-25', '617633', 'Caleb', 'Brennan', '(513) 497-8301', 'Waley', '1', 'Trainer #31', 'Yes', NULL),
    ('2025-03-25', '699442', 'Benie', 'Lumbuambu', '(859) 415-7196', 'Waley', '1', 'Trainer #42', 'Yes', NULL),
    ('2025-03-31', '671816', 'Nathan', 'McClellan', '513-801-0896', 'Geraldine', '1', 'Trainer #9', 'Yes', NULL),
    ('2025-03-31', '741979', 'Gerald', 'Cummings', '937-620-1894', 'Geraldine', '1', 'Trainer #42', 'Yes', NULL),
    ('2025-04-01', '671816', 'Nathan', 'McClellan', '513-801-0896', 'Geraldine', '1', 'Trainer #34', 'Yes', NULL),
    ('2025-04-07', '741979', 'Gerald', 'Cummings', '937-620-1894', 'Geraldine', '1', 'Trainer #8', 'Yes', NULL),
    ('2025-04-07', '#1461', 'Jonah', 'Baldwin', '513-503-9819', 'Curtis', '1', 'Trainer #42', 'Yes', NULL),
    ('2025-04-08', '699442', 'Benie', 'Lumbuambu', '(859) 415-7196', 'Waley', '1', 'Trainer #41', 'Yes', NULL),
    ('2025-04-09', '700224', 'Erin', 'Molar', '(513) 869-1177', 'Ron', '1', 'Soldering Kit #16', 'Yes', NULL),
    ('2025-04-14', '671816', 'Nathan', 'McClellan', '513-801-0896', 'Geraldine', '1', 'Trainer #8', 'Yes', NULL),
    ('2025-04-14', '#1461', 'Jonah', 'Baldwin', '513-503-9819', 'Curtis', '1', 'Trainer #31', 'Yes', NULL),
    ('2025-04-14', '741979', 'Gerald', 'Cummings', '937-620-1894', 'Geraldine', '1', 'Trainer #32', 'Yes', NULL),
    ('2025-04-15', '699442', 'Benie', 'Lumbuambu', '(859) 415-7196', 'Waley', '1', 'Trainer #34', 'Yes', NULL),
    ('2025-04-17', '699442', 'Benie', 'Lumbuambu', '(859) 415-7196', 'Waley', '1', 'Soldering Kit #35', 'Yes', NULL),
    ('2025-04-21', '#1461', 'Jonah', 'Baldwin', '513-503-9819', 'Curtis', '1', 'Trainer #32', 'Yes', NULL),
    ('2025-04-21', '741979', 'Gerald', 'Cummings', '937-620-1894', 'Geraldine', '1', 'Trainer #42', 'Yes', NULL),
    ('2025-04-22', '699442', 'Benie', 'Lumbuambu', '(859) 415-7196', 'Waley', '1', 'Trainer #31', 'Yes', NULL),
    ('2025-04-23', '721045', 'Tyler', 'Sansone', '(513) 903-0996', 'Ron', '1', 'Soldering Kit #31', 'Yes', NULL),
    ('2025-04-23', '738234', 'Benjamin', 'Weber', '812-716-6481', 'Curtis', '1', 'Trainer #34', 'Yes', NULL),
    ('2025-04-24', '676359', 'Jason', 'Stanley', '(513) 592-7216', 'Geraldine', '1', 'Soldering Kit #12, Breadboard', 'Yes', NULL),
    ('2025-04-24', '671816', 'Nathan', 'McClellan', '513-801-0896', 'Geraldine', '1', 'Trainer #31', 'Yes', NULL),
    ('2025-04-28', NULL, 'Larry', 'Unknown', NULL, 'Larry', '1 drawer', 'Screwdrivers', 'Yes', NULL),
    ('2025-04-28', '#1461', 'Jonah', 'Baldwin', '513-503-9819', 'Curtis', '1', 'Trainer #8', 'Yes', NULL),
    ('2025-04-28', '671816', 'Nathan', 'McClellan', '513-801-0896', 'Geraldine', '1', 'Trainer #8', 'Yes', NULL),
    ('2025-04-28', '741979', 'Gerald', 'Cummings', '937-620-1894', 'Geraldine', '1', 'Trainer #34', 'Yes', NULL),
    ('2025-04-29', '699442', 'Benie', 'Lumbuambu', '(859) 415-7196', 'Waley', '1', 'Trainer #41', 'Yes', NULL),
    ('2025-04-30', '749072', 'Arthur', 'Viirchanko', '(513) 302-8713', 'Waley', '1', 'Soldering Kit #2', 'No', NULL),
    ('2025-04-30', NULL, 'Ava', 'Chatman', '513-817-7259', 'Ralf', '1', 'Soldering Kit #31', 'Yes', NULL),
    ('2025-05-20', '598689', 'Quincy', 'Milton', '(513) 616-2311', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2025-05-20', '732042', 'Steven', 'Mose', '(513) 808-8690', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2025-05-20', '732042', 'Steven', 'Mose', '(513) 808-8690', 'Geraldine', '1', 'Trainer #34', 'Yes', NULL),
    ('2025-05-20', '754286', 'Daniel', 'Hoffer', '(513) 706-5730', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2025-07-03', '745890', 'Russ', 'Wright', '(513) 257-7539', 'Thelson', '1', 'Soldering Kit #37', 'Yes', NULL),
    ('2025-07-03', '676443', 'Daniel', 'Kaiser', '(513) 704-6652', 'Thelson', '1', 'Soldering Kit #25', 'Yes', NULL),
    ('2025-07-03', '691755', 'Imaed', 'Boudouma', '(513) 823-8869', 'Thelson', '1', 'Soldering Kit #33', 'Yes', NULL),
    ('2025-07-03', '755314', 'Geuillermo', 'Venegas', '(360) 674-6762', 'Thelson', '1', 'Soldering Kit #7', 'Yes', NULL),
    ('2025-07-28', '721661', 'Dontonio', 'Brown', '(513) 955-2673', 'Geraldine', '1', 'Wire Strippers', 'Yes', NULL),
    ('2025-08-12', '656060', 'Cameron', 'Wallace', '(513) 696-2861', 'Ron', '1', 'Soldering Kit #1 + 3 Sponges + Bottle', 'Yes', NULL),
    ('2025-08-12', '746378', 'Nathaniel', 'Offei', '(513) 633-5047', 'Ron', '1', 'Soldering Kit #21', 'Yes', NULL),
    ('2025-08-12', '728227', 'Erin', 'Grow', '(360) 922-2959', 'Ron', '1', 'Soldering Kit #31', 'Yes', NULL),
    ('2025-08-14', '656060', 'Cameron', 'Wallace', '(513) 696-2861', 'Ron', '1', 'Soldering Kit #2', 'Yes', NULL),
    ('2025-08-25', '745890', 'Russ', 'Wright', '(513) 257-7539', 'Geraldine', '1', 'Digital Kit', 'No', NULL),
    ('2025-08-25', '8366', 'Simon', 'Raver', '(859) 640-5167', 'Geraldine', '1', 'Digital Kit', 'Yes', NULL),
    ('2025-08-25', '7792', 'Divin', 'Ilunga', '(513) 816-9326', 'Geraldine', '1', 'Digital Kit', 'No', NULL),
    ('2025-08-25', '738234', 'Ben', 'Weber', '(812) 716-6481', 'Geraldine', '1', 'Digital Kit', 'No', NULL),
    ('2025-08-25', '707595', 'Jared', 'Moore', '(513) 575-6735', 'Geraldine', '1', 'Digital Kit', 'No', NULL),
    ('2025-08-29', 'labcenter', 'Lab', 'Center', 'yuh', '207 Cabinet', '1', 'Microcontroller #5', 'No', NULL),
    ('2025-09-03', '738234', 'Ben', 'Webber', '(812) 716-6481', 'Geraldine', '1', 'Trainer #41', 'Yes', NULL),
    ('2025-09-03', '707595', 'Jared', 'Moore', '(513) 575-6735', 'Geraldine', '1', 'Temporary Digital Kit', 'Yes', NULL),
    ('2025-09-03', '731773', 'Devin', 'Ilunga', '(513) 816-9326', 'Geraldine', '1', 'Trainer #34', 'Yes', NULL),
    ('2025-09-08', '729129', 'Abygale', 'Browning', '(513) 673-5792', 'Feghali', '1', 'Ruler', 'No', NULL),
    ('2025-09-10', '731773', 'Devin', 'Ilunga', '(513) 816-9326', 'Geraldine', '1', 'Trainer #8', 'Yes', NULL),
    ('2025-09-10', '738234', 'Ben', 'Webber', '(812) 716-6481', 'Geraldine', '1', 'Trainer #34', 'Yes', NULL),
    ('2025-09-15', '753628', 'Vince', 'Vogel', '(513) 518-7691', NULL, '1', 'Painter''S Tape', 'Yes', NULL),
    ('2025-09-10', '731773', 'Devin', 'Ilunga', '(513) 816-9326', 'Geraldine', '1', 'Trainer #8', 'Yes', NULL),
    ('2025-09-24', '731773', 'Devin', 'Ilunga', '(513) 816-9326', 'Geraldine', '1', 'Trainer #34', 'Yes', NULL),
    ('2025-09-03', '707595', 'Jared', 'Moore', '(513) 575-6735', 'Geraldine', '1', 'Temporary Digital Kit', 'Yes', NULL),
    ('2025-10-01', '731773', 'Devin', 'Ilunga', '(513) 816-9326', 'Geraldine', '1', 'Trainer #34', 'Yes', NULL);

;WITH BorrowerSource AS (
    SELECT
        l.SchoolID,
        l.FirstName,
        l.LastName,
        l.Phone,
        l.Instructor,
        ROW_NUMBER() OVER (
            PARTITION BY COALESCE(NULLIF(l.SchoolID, ''), CONCAT(UPPER(ISNULL(l.FirstName,'')), '|', UPPER(ISNULL(l.LastName,'')), '|', UPPER(ISNULL(l.Phone,''))))
            ORDER BY l.CheckoutDate
        ) AS rn
    FROM #LegacyLoans l
    WHERE ISNULL(l.FirstName, '') <> '' OR ISNULL(l.LastName, '') <> ''
)
INSERT INTO dbo.TBorrowers (strFirstName, strLastName, strSchoolIDNumber, strPhoneNumber, strInstructor, intDepartmentID)
SELECT DISTINCT
    bs.FirstName,
    bs.LastName,
    NULLIF(bs.SchoolID, ''),
    NULLIF(bs.Phone, ''),
    NULLIF(bs.Instructor, ''),
    @DefaultDeptID
FROM BorrowerSource bs
WHERE bs.rn = 1
  AND NOT EXISTS (
        SELECT 1
        FROM dbo.TBorrowers b
        WHERE (
            NULLIF(bs.SchoolID, '') IS NOT NULL AND b.strSchoolIDNumber = NULLIF(bs.SchoolID, '')
        ) OR (
            NULLIF(bs.SchoolID, '') IS NULL AND
            b.strFirstName = bs.FirstName AND
            b.strLastName = ISNULL(bs.LastName, '') AND
            ISNULL(b.strPhoneNumber, '') = ISNULL(bs.Phone, '')
        )

;WITH ItemSource AS (
    SELECT DISTINCT l.Material
    FROM #LegacyLoans l
)
INSERT INTO dbo.TItems (strItemName, blnIsSchoolOwned, intDepartmentID, strDescription)
SELECT
    isrc.Material,
    1,
    @DefaultDeptID,
    'Imported from legacy checkout spreadsheet' 
FROM ItemSource isrc
WHERE NOT EXISTS (
    SELECT 1 FROM dbo.TItems ti WHERE ti.strItemName = isrc.Material
);

;WITH LoanData AS (
    SELECT
        l.LegacyRowID,
        l.CheckoutDate,
        l.QtyLabel,
        l.Material,
        l.ReturnStatus,
        l.ReturnNote,
        CASE WHEN l.ReturnStatus IN ('Yes', 'Temporarily Yes', 'Disposable') THEN 1 ELSE 0 END AS IsReturned,
        (SELECT TOP 1 b.intBorrowerID FROM dbo.TBorrowers b WHERE (
            NULLIF(l.SchoolID, '') IS NOT NULL AND b.strSchoolIDNumber = NULLIF(l.SchoolID, '')
        ) OR (
            NULLIF(l.SchoolID, '') IS NULL AND b.strFirstName = l.FirstName AND b.strLastName = ISNULL(l.LastName, '') AND ISNULL(b.strPhoneNumber,'') = ISNULL(l.Phone,'')
        ) ORDER BY b.intBorrowerID) AS BorrowerID,
        (SELECT TOP 1 i.intItemID FROM dbo.TItems i WHERE i.strItemName = l.Material ORDER BY i.intItemID) AS ItemID,
        l.Instructor,
        l.Phone
    FROM #LegacyLoans l
)
INSERT INTO dbo.TItemLoans (
    intItemID, intBorrowerID, intCheckoutLabTechID, dtmCheckoutUTC, dtmDueUTC, strCheckoutNotes,
    dtmCheckinUTC, intCheckinLabTechID, strCheckinNotes,
    snapBorrowerFirstName, snapBorrowerLastName, snapSchoolIDNumber, snapPhoneNumber, snapRoomNumber, snapInstructor,
    snapItemName, snapItemNumber, snapIsSchoolOwned, snapDepartmentName
SELECT
    ld.ItemID,
    ld.BorrowerID,
    @CheckoutLabTechID,
    DATEADD(HOUR, 14, CAST(ld.CheckoutDate AS DATETIME2(0))),
    NULL,
    CONCAT('Legacy import - Qty: ', ISNULL(ld.QtyLabel, '1'), '; Instructor: ', ISNULL(ld.Instructor, 'Unknown')), 
    CASE WHEN ld.IsReturned = 1 THEN DATEADD(HOUR, 18, CAST(ld.CheckoutDate AS DATETIME2(0))) ELSE NULL END,
    CASE WHEN ld.IsReturned = 1 THEN @CheckoutLabTechID ELSE NULL END,
    CASE WHEN ld.ReturnStatus IS NOT NULL THEN CONCAT('Legacy status: ', ld.ReturnStatus, ISNULL(CONCAT(' - ', ld.ReturnNote), '')) ELSE ld.ReturnNote END,
    b.strFirstName,
    b.strLastName,
    b.strSchoolIDNumber,
    b.strPhoneNumber,
    b.strRoomNumber,
    b.strInstructor,
    i.strItemName,
    i.strItemNumber,
    i.blnIsSchoolOwned,
    d.strDepartmentName
FROM LoanData ld
JOIN dbo.TBorrowers b ON b.intBorrowerID = ld.BorrowerID
JOIN dbo.TItems i ON i.intItemID = ld.ItemID
LEFT JOIN dbo.TDepartments d ON d.intDepartmentID = i.intDepartmentID
WHERE ld.ItemID IS NOT NULL AND ld.BorrowerID IS NOT NULL
  AND NOT EXISTS (
        SELECT 1
        FROM dbo.TItemLoans existing
        WHERE existing.intItemID = ld.ItemID
          AND existing.intBorrowerID = ld.BorrowerID
          AND existing.dtmCheckoutUTC = DATEADD(HOUR, 14, CAST(ld.CheckoutDate AS DATETIME2(0)))
    );

DROP TABLE #LegacyLoans;
